2025-09-12 22:45:46,471 [INFO] 👀 Surveillance du dossier data\inbox... (Ctrl+C pour arrêter)
2025-09-12 22:46:03,132 [INFO] 📂 Nouveau fichier détecté : data\inbox\exemple_conformite.xlsx
2025-09-12 22:46:18,329 [INFO] ✅ Feuille Guideline traitée avec 40 lignes.
2025-09-12 22:46:18,329 [INFO] ✅ Feuille DONNEES HSE ERIS (0-100) traitée avec 2639 lignes.
2025-09-12 22:46:18,329 [INFO] ✅ Feuille Feuil1 traitée avec 2280 lignes.
2025-09-12 22:46:18,329 [INFO] ✅ Feuille Données Excel traitée avec 4490 lignes.
2025-09-12 22:46:18,329 [INFO] ✅ Feuille Données Excel(100_0) traitée avec 4480 lignes.
2025-09-12 22:46:18,329 [INFO] ✅ Feuille Suivi EP11 JPT traitée avec 92 lignes.
2025-09-12 22:46:18,329 [INFO] ✅ Feuille Données EP 11 traitée avec 3045 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille Score Excel Vs Eris traitée avec 4502 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille Feuil2 traitée avec 73 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille ASNE traitée avec 63 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille ACE traitée avec 165 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille AFO traitée avec 148 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille MOI traitée avec 150 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille NIG traitée avec 11 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille NIG trame traitée avec 12 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille AFR trame traitée avec 143 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille Suivi resultats ERIS AFR trame traitée avec 65 lignes.
2025-09-12 22:46:18,330 [INFO] ✅ Feuille Fichier de base score  traitée avec 2495 lignes.
2025-09-12 22:46:18,331 [INFO] 📦 Fichier archivé -> data\archive\exemple_conformite_20250912_224618.xlsx
2025-09-13 01:38:51,140 [INFO] Arrêt demandé, arrêt de l'observer...
2025-09-13 01:38:51,194 [INFO] Observer arrêté.
2025-09-13 02:15:34,358 [INFO] 👀 Surveillance du dossier data\inbox... (Ctrl+C pour arrêter)
2025-09-13 02:17:21,576 [INFO] 📂 Nouveau fichier détecté : data\inbox\exemple_conformite.xlsx
2025-09-13 02:17:49,878 [INFO] ✅ Feuille Guideline traitée avec 40 lignes.
2025-09-13 02:17:49,879 [INFO] ✅ Feuille DONNEES HSE ERIS (0-100) traitée avec 2639 lignes.
2025-09-13 02:17:49,879 [INFO] ✅ Feuille Feuil1 traitée avec 2280 lignes.
2025-09-13 02:17:49,879 [INFO] ✅ Feuille Données Excel traitée avec 4490 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille Données Excel(100_0) traitée avec 4480 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille Suivi EP11 JPT traitée avec 92 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille Données EP 11 traitée avec 3045 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille Score Excel Vs Eris traitée avec 4502 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille Feuil2 traitée avec 73 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille ASNE traitée avec 63 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille ACE traitée avec 165 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille AFO traitée avec 148 lignes.
2025-09-13 02:17:49,880 [INFO] ✅ Feuille MOI traitée avec 150 lignes.
2025-09-13 02:17:49,881 [INFO] ✅ Feuille NIG traitée avec 11 lignes.
2025-09-13 02:17:49,881 [INFO] ✅ Feuille NIG trame traitée avec 12 lignes.
2025-09-13 02:17:49,881 [INFO] ✅ Feuille AFR trame traitée avec 143 lignes.
2025-09-13 02:17:49,882 [INFO] ✅ Feuille Suivi resultats ERIS AFR trame traitée avec 65 lignes.
2025-09-13 02:17:49,882 [INFO] ✅ Feuille Fichier de base score  traitée avec 2495 lignes.
2025-09-13 02:17:49,891 [INFO] 📦 Fichier archivé -> data\archive\exemple_conformite_20250913_021749.xlsx
2025-09-13 02:36:40,022 [INFO] 📂 Nouveau fichier détecté : data\inbox\Invariants - calculs_test.xlsx
2025-09-13 02:36:45,459 [ERROR] ❌ Erreur globale lors de l’import de data\inbox\Invariants - calculs_test.xlsx : Passed header=[4], len of 1, but only 1 lines in file (sheet: Hypothèse )
Traceback (most recent call last):
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\parsers\python_parser.py", line 716, in _next_line
    line = self._check_comments([self.data[self.pos]])[0]
                                 ~~~~~~~~~^^^^^^^^^^
IndexError: list index out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\parsers\python_parser.py", line 407, in _infer_columns
    line = self._next_line()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\parsers\python_parser.py", line 729, in _next_line
    raise StopIteration
StopIteration

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\brand\PycharmProjects\PythonProject1\watcher.py", line 79, in on_created
    results = process_excel(str(src_path))  # retourne {sheet_name: df}
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\processor.py", line 41, in process_excel
    ).read()
      ^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\excel_schema_reader.py", line 64, in read
    dfs = pd.read_excel(self.path, sheet_name=None, header=self.header_row, engine="openpyxl")
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
           ^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 916, in parse
    raise err
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 878, in parse
    parser = TextParser(
             ^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 2053, in TextParser
    return TextFileReader(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\parsers\python_parser.py", line 133, in __init__
    ) = self._infer_columns()
        ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\brand\PycharmProjects\PythonProject1\.venv\Lib\site-packages\pandas\io\parsers\python_parser.py", line 417, in _infer_columns
    raise ValueError(
ValueError: Passed header=[4], len of 1, but only 1 lines in file (sheet: Hypothèse )
2025-09-13 02:36:45,703 [INFO] 🚩 Fichier déplacé en erreur -> data\error\Invariants - calculs_test.xlsx
2025-09-13 02:37:30,542 [INFO] Arrêt demandé, arrêt de l'observer...
2025-09-13 02:37:30,546 [INFO] Observer arrêté.
2025-09-13 03:30:29,254 [INFO] 👀 Surveillance active sur data\inbox... (Ctrl+C pour arrêter)
2025-09-13 03:30:36,296 [INFO] 📂 Nouveau fichier détecté : data\inbox\Invariants - calculs_test.xlsx
2025-09-13 03:35:14,021 [INFO] ✅ Feuille 'PLT 24-30 (Old zones)' traitée (48 lignes, 51 colonnes)
2025-09-13 03:35:14,024 [INFO] ✅ Feuille 'besoin Capex Vs PLT 2024' traitée (74 lignes, 48 colonnes)
2025-09-13 03:35:14,024 [INFO] ✅ Feuille 'REPORTING_AFR' traitée (79 lignes, 25 colonnes)
2025-09-13 03:35:14,024 [INFO] ✅ Feuille 'conformité_BUvsPC_2021' traitée (69 lignes, 38 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'CAD 24' traitée (229 lignes, 32 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'REPORTING_AFR_17.07.25' traitée (100 lignes, 70 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'Pu_filiale' traitée (41 lignes, 29 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'REPORTING_MKRD_01.24' traitée (93 lignes, 33 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'AFR' traitée (223 lignes, 62 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'AFR 2026' traitée (58 lignes, 29 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'BU AFR' traitée (133 lignes, 50 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'BU_NIG' traitée (56 lignes, 92 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'BU_MOI' traitée (144 lignes, 92 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'BU_ANBE' traitée (143 lignes, 92 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'BU_AFO' traitée (158 lignes, 93 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'BU_ACE' traitée (157 lignes, 92 colonnes)
2025-09-13 03:35:14,025 [INFO] ✅ Feuille 'AFR (PC)' traitée (199 lignes, 62 colonnes)
2025-09-13 03:35:14,026 [INFO] ✅ Feuille 'NIG' traitée (25 lignes, 113 colonnes)
2025-09-13 03:35:14,026 [INFO] ✅ Feuille 'MOI (PC)' traitée (124 lignes, 133 colonnes)
2025-09-13 03:35:14,026 [INFO] ✅ Feuille 'MOI' traitée (125 lignes, 133 colonnes)
2025-09-13 03:35:14,026 [INFO] ✅ Feuille 'AFO (PC)' traitée (146 lignes, 133 colonnes)
2025-09-13 03:35:14,026 [INFO] ✅ Feuille 'AFO' traitée (145 lignes, 133 colonnes)
2025-09-13 03:35:14,026 [INFO] ✅ Feuille 'ACE (PC)' traitée (136 lignes, 133 colonnes)
2025-09-13 03:35:14,026 [INFO] ✅ Feuille 'ACE' traitée (135 lignes, 133 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'AFA (PC)' traitée (126 lignes, 133 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'ANBE' traitée (122 lignes, 133 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Nigéria' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Mayotte' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Egypte' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Erythrée' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Ethiopie' traitée (592 lignes, 146 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Madagascar' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Maroc' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Maurice' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Réunion' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Tunisie' traitée (591 lignes, 146 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Burkina' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,027 [INFO] ✅ Feuille 'Togo' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,028 [INFO] ✅ Feuille 'Tchad' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,028 [INFO] ✅ Feuille 'Sénégal' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,028 [INFO] ✅ Feuille 'Mali' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,028 [INFO] ✅ Feuille 'Ghana' traitée (555 lignes, 146 colonnes)
2025-09-13 03:35:14,028 [INFO] ✅ Feuille 'Centafrique' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,028 [INFO] ✅ Feuille 'Côte Ivoire' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,028 [INFO] ✅ Feuille 'Guinée' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,028 [INFO] ✅ Feuille 'Afrique du Sud' traitée (605 lignes, 144 colonnes)
2025-09-13 03:35:14,030 [INFO] ✅ Feuille 'Botswana' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,030 [INFO] ✅ Feuille 'Eswatini' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,030 [INFO] ✅ Feuille 'Malawi' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,030 [INFO] ✅ Feuille 'Angola' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,030 [INFO] ✅ Feuille 'Mozambique' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,030 [INFO] ✅ Feuille 'Namibie' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Zimbabwe' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Zambie' traitée (617 lignes, 146 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Cameroun' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Congo RDC' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Congo Brazza' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Gabon' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Guinée Equitoriale' traitée (595 lignes, 144 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Kenya' traitée (593 lignes, 145 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Uganda' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'Tanzania' traitée (595 lignes, 146 colonnes)
2025-09-13 03:35:14,031 [INFO] ✅ Feuille 'nbr site 100% conforme' traitée (54 lignes, 23 colonnes)
2025-09-13 03:35:14,032 [INFO] ✅ Feuille 'Comparaison nbre sites' traitée (48 lignes, 52 colonnes)
2025-09-13 03:35:14,032 [INFO] ✅ Feuille 'Bridge_nbre station 2022 ' traitée (41 lignes, 33 colonnes)
2025-09-13 03:35:14,032 [INFO] ✅ Feuille 'Bridge_nbre station 2023' traitée (41 lignes, 45 colonnes)
2025-09-13 03:35:14,061 [ERROR] ❌ Erreur lors du traitement de data\inbox\Invariants - calculs_test.xlsx : [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Invariants - calculs_test.xlsx'
Traceback (most recent call last):
  File "C:\Users\brand\AppData\Local\Programs\Python\Python312\Lib\shutil.py", line 886, in move
    os.rename(src, real_dst)
PermissionError: [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Invariants - calculs_test.xlsx' -> 'data\\archive\\Invariants - calculs_test.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\brand\PycharmProjects\PythonProject1\watcher.py", line 96, in on_created
    shutil.move(str(src_path), str(dest))
  File "C:\Users\brand\AppData\Local\Programs\Python\Python312\Lib\shutil.py", line 907, in move
    os.unlink(src)
PermissionError: [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Invariants - calculs_test.xlsx'
2025-09-13 03:35:14,108 [ERROR] ❌ Impossible de déplacer en erreur : [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Invariants - calculs_test.xlsx'
2025-09-13 03:35:14,282 [INFO] 📂 Nouveau fichier détecté : data\inbox\Extraction_test - Copie.xlsx
2025-09-13 03:35:36,112 [INFO] ✅ Feuille 'Inspections' traitée (83 lignes, 14 colonnes)
2025-09-13 03:35:36,115 [INFO] ✅ Feuille 'Actions' traitée (10850 lignes, 11 colonnes)
2025-09-13 03:35:36,116 [INFO] ✅ Feuille 'Questions' traitée (1713 lignes, 359 colonnes)
2025-09-13 03:35:36,116 [INFO] ✅ Feuille 'HSE Invariants (2)' traitée (1713 lignes, 31 colonnes)
2025-09-13 03:35:36,116 [INFO] ✅ Feuille 'HSE Invariants' traitée (1713 lignes, 31 colonnes)
2025-09-13 03:35:36,124 [ERROR] ❌ Erreur lors du traitement de data\inbox\Extraction_test - Copie.xlsx : [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Extraction_test - Copie.xlsx'
Traceback (most recent call last):
  File "C:\Users\brand\AppData\Local\Programs\Python\Python312\Lib\shutil.py", line 886, in move
    os.rename(src, real_dst)
PermissionError: [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Extraction_test - Copie.xlsx' -> 'data\\archive\\Extraction_test - Copie.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\brand\PycharmProjects\PythonProject1\watcher.py", line 96, in on_created
    shutil.move(str(src_path), str(dest))
  File "C:\Users\brand\AppData\Local\Programs\Python\Python312\Lib\shutil.py", line 907, in move
    os.unlink(src)
PermissionError: [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Extraction_test - Copie.xlsx'
2025-09-13 03:35:36,137 [ERROR] ❌ Impossible de déplacer en erreur : [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Extraction_test - Copie.xlsx'
2025-09-13 03:38:50,087 [INFO] 🛑 Arrêt demandé, fermeture du watcher...
2025-09-13 03:38:50,118 [INFO] ✅ Watcher arrêté proprement.
2025-09-13 03:39:21,570 [INFO] 👀 Surveillance active sur data\inbox... (Ctrl+C pour arrêter)
2025-09-13 03:39:48,808 [INFO] 📂 Nouveau fichier détecté : data\inbox\Extraction_test - Copie.xlsx
2025-09-13 03:40:08,241 [INFO] ✅ Feuille 'Inspections' traitée (83 lignes, 14 colonnes)
2025-09-13 03:40:08,241 [INFO] ✅ Feuille 'Actions' traitée (10850 lignes, 11 colonnes)
2025-09-13 03:40:08,241 [INFO] ✅ Feuille 'Questions' traitée (1713 lignes, 359 colonnes)
2025-09-13 03:40:08,241 [INFO] ✅ Feuille 'HSE Invariants (2)' traitée (1713 lignes, 31 colonnes)
2025-09-13 03:40:08,241 [INFO] ✅ Feuille 'HSE Invariants' traitée (1713 lignes, 31 colonnes)
2025-09-13 03:40:08,249 [ERROR] ❌ Erreur lors du traitement de data\inbox\Extraction_test - Copie.xlsx : [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Extraction_test - Copie.xlsx'
Traceback (most recent call last):
  File "C:\Users\brand\AppData\Local\Programs\Python\Python312\Lib\shutil.py", line 886, in move
    os.rename(src, real_dst)
PermissionError: [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Extraction_test - Copie.xlsx' -> 'data\\archive\\Extraction_test - Copie_20250913_034008.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\brand\PycharmProjects\PythonProject1\watcher.py", line 96, in on_created
    shutil.move(str(src_path), str(dest))
  File "C:\Users\brand\AppData\Local\Programs\Python\Python312\Lib\shutil.py", line 907, in move
    os.unlink(src)
PermissionError: [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Extraction_test - Copie.xlsx'
2025-09-13 03:40:08,259 [ERROR] ❌ Impossible de déplacer en erreur : [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Extraction_test - Copie.xlsx'
2025-09-13 03:40:08,262 [INFO] 📂 Nouveau fichier détecté : data\inbox\Invariants - calculs_test.xlsx
2025-09-13 03:44:44,140 [INFO] ✅ Feuille 'PLT 24-30 (Old zones)' traitée (48 lignes, 51 colonnes)
2025-09-13 03:44:44,142 [INFO] ✅ Feuille 'besoin Capex Vs PLT 2024' traitée (74 lignes, 48 colonnes)
2025-09-13 03:44:44,142 [INFO] ✅ Feuille 'REPORTING_AFR' traitée (79 lignes, 25 colonnes)
2025-09-13 03:44:44,142 [INFO] ✅ Feuille 'conformité_BUvsPC_2021' traitée (69 lignes, 38 colonnes)
2025-09-13 03:44:44,142 [INFO] ✅ Feuille 'CAD 24' traitée (229 lignes, 32 colonnes)
2025-09-13 03:44:44,142 [INFO] ✅ Feuille 'REPORTING_AFR_17.07.25' traitée (100 lignes, 70 colonnes)
2025-09-13 03:44:44,142 [INFO] ✅ Feuille 'Pu_filiale' traitée (41 lignes, 29 colonnes)
2025-09-13 03:44:44,142 [INFO] ✅ Feuille 'REPORTING_MKRD_01.24' traitée (93 lignes, 33 colonnes)
2025-09-13 03:44:44,142 [INFO] ✅ Feuille 'AFR' traitée (223 lignes, 62 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'AFR 2026' traitée (58 lignes, 29 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'BU AFR' traitée (133 lignes, 50 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'BU_NIG' traitée (56 lignes, 92 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'BU_MOI' traitée (144 lignes, 92 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'BU_ANBE' traitée (143 lignes, 92 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'BU_AFO' traitée (158 lignes, 93 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'BU_ACE' traitée (157 lignes, 92 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'AFR (PC)' traitée (199 lignes, 62 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'NIG' traitée (25 lignes, 113 colonnes)
2025-09-13 03:44:44,144 [INFO] ✅ Feuille 'MOI (PC)' traitée (124 lignes, 133 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'MOI' traitée (125 lignes, 133 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'AFO (PC)' traitée (146 lignes, 133 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'AFO' traitée (145 lignes, 133 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'ACE (PC)' traitée (136 lignes, 133 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'ACE' traitée (135 lignes, 133 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'AFA (PC)' traitée (126 lignes, 133 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'ANBE' traitée (122 lignes, 133 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Nigéria' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Mayotte' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Egypte' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Erythrée' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Ethiopie' traitée (592 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Madagascar' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Maroc' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Maurice' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Réunion' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Tunisie' traitée (591 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Burkina' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Togo' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Tchad' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Sénégal' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Mali' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Ghana' traitée (555 lignes, 146 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Centafrique' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Côte Ivoire' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Guinée' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,145 [INFO] ✅ Feuille 'Afrique du Sud' traitée (605 lignes, 144 colonnes)
2025-09-13 03:44:44,146 [INFO] ✅ Feuille 'Botswana' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,146 [INFO] ✅ Feuille 'Eswatini' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,146 [INFO] ✅ Feuille 'Malawi' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,146 [INFO] ✅ Feuille 'Angola' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,146 [INFO] ✅ Feuille 'Mozambique' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Namibie' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Zimbabwe' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Zambie' traitée (617 lignes, 146 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Cameroun' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Congo RDC' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Congo Brazza' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Gabon' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Guinée Equitoriale' traitée (595 lignes, 144 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Kenya' traitée (593 lignes, 145 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Uganda' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Tanzania' traitée (595 lignes, 146 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'nbr site 100% conforme' traitée (54 lignes, 23 colonnes)
2025-09-13 03:44:44,147 [INFO] ✅ Feuille 'Comparaison nbre sites' traitée (48 lignes, 52 colonnes)
2025-09-13 03:44:44,148 [INFO] ✅ Feuille 'Bridge_nbre station 2022 ' traitée (41 lignes, 33 colonnes)
2025-09-13 03:44:44,148 [INFO] ✅ Feuille 'Bridge_nbre station 2023' traitée (41 lignes, 45 colonnes)
2025-09-13 03:44:44,166 [ERROR] ❌ Erreur lors du traitement de data\inbox\Invariants - calculs_test.xlsx : [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Invariants - calculs_test.xlsx'
Traceback (most recent call last):
  File "C:\Users\brand\AppData\Local\Programs\Python\Python312\Lib\shutil.py", line 886, in move
    os.rename(src, real_dst)
PermissionError: [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Invariants - calculs_test.xlsx' -> 'data\\archive\\Invariants - calculs_test_20250913_034444.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\brand\PycharmProjects\PythonProject1\watcher.py", line 96, in on_created
    shutil.move(str(src_path), str(dest))
  File "C:\Users\brand\AppData\Local\Programs\Python\Python312\Lib\shutil.py", line 907, in move
    os.unlink(src)
PermissionError: [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Invariants - calculs_test.xlsx'
2025-09-13 03:44:44,181 [ERROR] ❌ Impossible de déplacer en erreur : [WinError 32] Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus: 'data\\inbox\\Invariants - calculs_test.xlsx'
2025-09-13 03:48:05,759 [INFO] 🛑 Arrêt demandé, fermeture du watcher...
2025-09-13 03:48:05,837 [INFO] ✅ Watcher arrêté proprement.
